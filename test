# Extract first three octets and create a new column
df_with_octets = df.withColumn(
    "first_three_octets",
    expr("substring(ip_address, 1, locate('.', ip_address, locate('.', ip_address, locate('.', ip_address) + 1) + 1) - 1)")
)
